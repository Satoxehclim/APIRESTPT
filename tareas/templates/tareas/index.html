<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Tareas</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .completada { color: green; font-weight: bold; }
        .pendiente { color: red; }
    </style>
</head>
<body>
    <h1>Mis Tareas (Consumiendo API)</h1>
    
    <table id="tabla-tareas">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Estado</th>
                <th>Fecha Creación</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>

    <script>
        // Esta función consume TU propia API
        async function cargarTareas() {
            try {
                const response = await fetch('/api/tareas/');
                if (!response.ok) {
                    document.body.innerHTML += "<p style='color:red'>Error: No estás logueado o la API falló.</p>";
                    return;
                }
                const tareas = await response.json();
                
                const tbody = document.querySelector('#tabla-tareas tbody');
                tbody.innerHTML = ''; // Limpiar tabla

                tareas.forEach(tarea => {
                    const fila = `
                        <tr>
                            <td>${tarea.nombre}</td>
                            <td>
                                <span class="${tarea.completada ? 'completada' : 'pendiente'}">
                                    ${tarea.completada ? 'Completada' : 'Pendiente'}
                                </span>
                            </td>
                            <td>${new Date(tarea.fecha_creacion).toLocaleString()}</td>
                        </tr>
                    `;
                    tbody.innerHTML += fila;
                });
            } catch (error) {
                console.error('Error cargando tareas:', error);
            }
        }

        // Cargar al abrir la página
        cargarTareas();
    </script>
</body>
</html>